% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/flagASRcont.R
\name{flagRoC}
\alias{flagRoC}
\title{Apply rate-of-change QC flag}
\usage{
flagRoC(flag, vals, datetimes, meta)
}
\arguments{
\item{flag}{character vector of current flag values (\code{"pass"},
\code{"suspect"}, or \code{"fail"}).}

\item{vals}{numeric vector of observed values, the same length as
\code{flag}.}

\item{datetimes}{POSIXct vector of observation timestamps, the same length
as \code{flag}.}

\item{meta}{single-row data frame of metadata for the parameter being
checked.  Optional numeric columns \code{RoCStdev} (number of standard
deviations) and \code{RoCHours} (full window width in hours) control the
check.  If either column is absent or \code{NA} the check is skipped.}
}
\value{
Updated character flag vector.
}
\description{
Apply rate-of-change QC flag
}
\details{
For each observation the absolute difference from the previous
observation is compared to \code{RoCStdev} Ã— the standard deviation of
all absolute differences within a \code{RoCHours}-hour window centered
on that observation.  The observation is flagged \code{"suspect"} if its
difference exceeds this threshold.  At least 3 differences must fall
within the window; otherwise the observation is skipped.  This check
only produces \code{"suspect"} flags; it does not produce \code{"fail"}
flags.
}
\examples{
flag <- rep("pass", 6)
vals <- c(10, 10.2, 10.1, 10.3, 15.0, 10.2)
datetimes <- as.POSIXct("2024-01-01") + seq(0, 5) * 900  # 15-min intervals
meta <- data.frame(RoCStdev = 3, RoCHours = 2)
flagRoC(flag, vals, datetimes, meta)
}
